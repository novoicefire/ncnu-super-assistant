# **產品需求文件（PRD）：暨大生超級助理 \- 校園導航功能（照片步驟全面版MVP）**

**版本**：1.4（完整技術設計版）  
**作者**：楊承逸（112212007，國際企業學系）  
**日期**：2025年12月23日  
**指導老師**：駱世民教授  
**計畫連結**：此PRD為自主學習計畫第二階段輸出，基於第一階段問卷分析（82份回應）與痛點診斷，調整校園平面圖缺失問題，採用照片一步步引導（Street View式）替代影片/平面圖，並擴充至全面室內標的覆蓋（教室/辦公室/廁所/飲水機/電梯/樓梯等）。本版本新增完整資料庫設計與照片模組化策略，大幅降低拍攝工作量。

## **1\. 版本歷史**

* v1.0 (2025/11/14)：初稿，整合問卷數據與KPI框架。  
* v1.1 (2025/11/14)：影片引導MVP調整。  
* v1.2 (2025/11/14)：改為照片步驟導航。  
* v1.3 (2025/11/14)：擴充全面標的覆蓋（\>500標的），新增眾包與標的覆蓋率KPI。
* v1.4 (2025/12/23)：完整技術設計版。新增資料庫 Schema 設計（6張表含時間戳記）、照片模組化策略（減少70%工作量）、開發時程規劃（18週）、眾包SOP、前端元件/後端API規劃、無障礙設計；擴充附錄（建築物清單、使用者旅程圖、資料範例）；新增目錄導航與 API 費用風險；修正文件格式與內容一致性。

## **2\. 摘要**

此PRD定義「暨大生超級助理」網站新增「校園導航」功能的規格，針對校園內新生與訪客的導航痛點，提供室外地圖路徑與照片一步步室內引導（模擬Street View前進），支援全面標的查詢（教室、辦公室、廁所、飲水機、電梯、樓梯、戶外景點等\>500個），提升到達效率、資訊詳細度與導航可靠度。 因學校無樓層平面圖，MVP用預拍照片序列（每標的5-15步）+眾包擴充，整合現有網站（[https://ncnu-super-assistant.vercel.app/course-planner](https://ncnu-super-assistant.vercel.app/course-planner)），於一學期內完成發布，預計服務60%以上網站使用者（60.98%基底）。 核心目標：實現產品優化循環，輸出可用性測試報告，對應PMMC學程K/S/A能力（Knowledge：全面痛點分析；Skill：眾包擴充規格；Attitude：包容所有使用者需求與資源優化）。

### **目錄**

1. [版本歷史](#1-版本歷史)
2. [摘要](#2-摘要)
3. [問題陳述與動機](#3-問題陳述與動機)
4. [使用者角色與需求](#4-使用者角色與需求)
5. [功能範圍](#5-功能範圍)
6. [非功能需求](#6-非功能需求)
   - [6.1 資料庫設計](#61-資料庫設計supabase-postgresql)
   - [6.2 照片模組化策略](#62-照片模組化策略)
   - [6.3 開發時程規劃](#63-開發時程規劃)
   - [6.4 眾包貢獻流程（SOP）](#64-眾包貢獻流程sop)
   - [6.5 前端元件規劃](#65-前端元件規劃)
   - [6.6 後端 API 規劃](#66-後端-api-規劃)
   - [6.7 無障礙設計](#67-無障礙設計)
7. [KPI與成功指標](#7-kpi與成功指標)
8. [依賴與風險](#8-依賴與風險)
9. [附錄](#9-附錄)

## **3\. 問題陳述與動機**

校園內場館與教室位置複雜，新生（53.66%問卷受測者）與訪客常因不熟悉導航而困擾，導致遲到率達36.59%。 現有工具如Google Maps存在三大痛點：資訊詳細度低（建築標示不清，17.07%最困擾）、導航可靠度不足（室內指引止於室外，14.63%問題率）、到達效率差（路線繞路，3.66%最困擾）。 問卷顯示84.15%使用者遇過至少一項問題，幫助度預期3.88/5，推薦意願8.82/10；開放回饋強調行政處室/劇場難找、周邊設施（如廁所/飲水機10%希望）。 本功能以網站為基底，透過照片步驟全面覆蓋室內標的（\>80%查詢情境），解決這些痛點，提升校園動線體驗；MVP避免平面圖依賴，聚焦眾包迭代。

## **4\. 使用者角色與需求**

### **4.1 使用者角色**

* **主要使用者**：大一新生（53.66%），熟悉度低（41.46%僅知自己學院），需快速找到教室/設施（如A100或樓梯）。  
* **次要使用者**：訪客/高年級生（39.02%熟悉大部分路線），需辦公室/活動地點（如方形劇場）與周邊（如飲水機）。  
* **邊緣使用者**：僑生/行動不便者（開放回饋提及公車/無障礙需求），需電梯/廁所等設施指引。

### **4.2 使用者故事**

基於問卷緊急情境（10分鐘到教室）與設施需求，定義以下故事：

* 作為新生，我能在輸入任教室編號（如A100）或設施（如飲水機）後，獲得照片步驟引導（包括入口到門口/位置），以避免遲到（34.15%最困擾無法導航教室）。  
* 作為訪客，我希望搜尋辦公室/劇場時，看到全面步驟與周邊標註（如附近廁所，10%希望特色）。  
* 作為常使用者，我需回報/上傳照片擴充少見標的（如樓梯過時），維持全面覆蓋（回報意願2.27/5，需簡化眾包）。  
* 作為網站使用者（60.98%用過），我希望導航無縫整合課程規劃，任一標的查詢無死角。

## **5\. 功能範圍**

### **5.1 核心功能（MVP）**

* **地標搜尋**：支援全面標的輸入：教室編號（如A100/B01-2）、辦公室（如「教務處」）、設施（如「廁所/飲水機/電梯/樓梯」）、其他（如劇場/廣場/宿舍）；關鍵字搜尋（e.g., "人院2樓廁所"），自動建議（基於學院占比：管理/人文53%、科技15%）。資料庫涵蓋校園\>500標的（含 59 個地點），MVP優先教室/行政/主要設施80%。  
* **最佳化路徑**（室外導航）：使用 Google Maps Embed（免費 iframe 嵌入）顯示從校門口到各建築物入口的室外路線，提供預估時間/距離（14.63%希望）。使用者到達建築物入口後，點擊「開始室內導航」切換至照片步驟導航。  
* **照片步驟導航**（全面室內引導）：預拍/眾包系列照片（每標的5-15步，總10-20張），模擬Street View前進：  
  * **核心標的**（MVP全覆蓋）：所有教室（e.g., 人院A100→門口，34.15%痛點）；辦公室/行政（如方形劇場，開放回饋難找）；主要設施（廁所/飲水機/電梯/樓梯，每建築1-2組通用步驟）。  
  * **步驟邏輯**：從入口開始，按「下一步」按鈕前進，每步顯示照片+箭頭疊加（e.g., "電梯按3樓"）+文字描述（"剩餘1分鐘"）；支援分支（e.g., 樓梯/電梯選擇，5%無障礙）；周邊標註（e.g., 步驟中彈窗"附近飲水機"）。  
  * **通用/擴充**：非核心標的用模組化步驟（e.g., "科技學院3樓通用"適用多教室）；眾包機制（使用者上傳照片/步驟，審核後整合）。WebP格式，縮放/全螢幕。涵蓋所有室內可能位置（\>80%查詢情境）。  
* **錯誤回報與眾包**：一鍵上傳照片/描述，標記錯誤類型（標示錯/封路/步驟過時）；擴充為眾包貢獻（"缺此標的？上傳步驟"），後台審核（AI初步+手動），加速全面覆蓋（14日修正≥80%）。  
* **周邊整合**：全面標的互聯（e.g., 導航教室途中標廁所/電梯，10%選率）；無障礙模式（樓梯/電梯分步，5%希望）。

### **5.2 優先級與Out-of-Scope**

* 高優先：教室/辦公室/主要設施（\>80%查詢，e.g., 所有電梯/樓梯步驟）；搜尋、照片步驟、回報/眾包。  
* 中優先：次要設施擴充（飲水機/販賣機，眾包迭代）；AR疊加照片（2人AR建議）。  
* 排除：即時定位（無平面圖，眾包後加）。

## **6\. 非功能需求**

* **效能**：照片載入≤1秒/步；搜尋回應≤2秒（\>500標的資料庫）。  
* **可用性**：SUS≥70；步驟支援搜尋內標的（e.g., "跳到電梯"）；行動端適配（\>80%手機）。  
* **安全性**：匿名位置/眾包資料，GDPR合規；上傳驗證防濫用（e.g., 尺寸/內容審核）。  
* **可擴充性**：資料庫（Supabase PostgreSQL）支援動態新增標的/步驟；眾包審核SOP（匿名/驗證），負載≥1000日活。  
* **相容性**：瀏覽器（Chrome/Safari），整合現有網站CSS。
* **離線支援**：預載下一步照片，關鍵路線支援離線快取。

### **6.1 資料庫設計（Supabase PostgreSQL）**

本功能採用 Supabase PostgreSQL 作為資料庫，設計 6 張資料表實現模組化導航架構：

#### **6.1.1 資料表總覽**

| 資料表 | 用途 | 關聯 |
| :--- | :--- | :--- |
| `nav_locations` | 地點基本資訊（建築物/戶外場地/景觀） | — |
| `nav_destinations` | 目的地（教室/辦公室/設施） | FK → locations |
| `nav_path_segments` | 可複用路徑段 | FK → locations |
| `nav_photos` | 導航照片元資料 | FK → segments / destinations |
| `nav_routes` | 預計算完整路線 | FK → destinations, array of segments |
| `nav_crowdsource` | 眾包貢獻追蹤 | FK → destinations |

#### **6.1.2 各資料表結構**

**nav_locations（地點）**

| 欄位 | 類型 | 說明 |
| :--- | :--- | :--- |
| id | SERIAL PK | 主鍵 |
| code | TEXT UNIQUE | 地點代碼（如 HUM, MGT, SCI, SNP） |
| name_zh | TEXT | 中文名稱（人文學院） |
| name_en | TEXT | 英文名稱 |
| aliases | TEXT[] | 別名陣列（['人院', '人文']） |
| location | JSONB | 座標 {lat, lng} |
| floors | INTEGER | 樓層數（戶外場地 = NULL） |
| has_elevator | BOOLEAN | 是否有電梯（戶外 = NULL） |
| location_type | TEXT | 地點類型: building/outdoor/landscape |
| created_at | TIMESTAMPTZ | 建立時間（自動） |
| updated_at | TIMESTAMPTZ | 更新時間（自動） |

**nav_destinations（目的地）**

| 欄位 | 類型 | 說明 |
| :--- | :--- | :--- |
| id | SERIAL PK | 主鍵 |
| location_id | INTEGER FK | 所屬地點 |
| type | TEXT | 類型: classroom/office/restroom/elevator/stairs/water/theater/cafeteria/store/atm/library/dorm/parking/entrance/outdoor/landscape/post_office/copy_center/health_center/other |
| code | TEXT | 編號（A101、教務處） |
| name_zh | TEXT | 中文名稱 |
| floor | INTEGER | 樓層 |
| aliases | TEXT[] | 別名陣列 |
| tags | TEXT[] | 標籤（['無障礙', '男廁']） |
| is_accessible | BOOLEAN | 是否無障礙友善 |
| created_at | TIMESTAMPTZ | 建立時間（自動） |
| updated_at | TIMESTAMPTZ | 更新時間（自動） |

**nav_path_segments（路徑段）- 核心模組化**

| 欄位 | 類型 | 說明 |
| :--- | :--- | :--- |
| id | SERIAL PK | 主鍵 |
| location_id | INTEGER FK | 所屬地點（可為 NULL） |
| segment_type | TEXT | 類型: entrance/corridor/stairs/elevator/floor |
| start_node | TEXT | 起點節點 ID（如 HUM_ENTRANCE） |
| end_node | TEXT | 終點節點 ID（如 HUM_F1_LOBBY） |
| description_zh | TEXT | 中文描述 |
| floor | INTEGER | 樓層 |
| direction | TEXT | 方向: up/down/horizontal |
| estimated_time | INTEGER | 預估秒數 |
| is_accessible | BOOLEAN | 是否無障礙友善 |
| created_at | TIMESTAMPTZ | 建立時間（自動） |
| updated_at | TIMESTAMPTZ | 更新時間（自動） |

**nav_photos（照片）**

| 欄位 | 類型 | 說明 |
| :--- | :--- | :--- |
| id | SERIAL PK | 主鍵 |
| segment_id | INTEGER FK | 所屬路徑段（與 destination_id 二選一） |
| destination_id | INTEGER FK | 所屬目的地 |
| order_index | INTEGER | 順序索引 |
| storage_path | TEXT | Supabase Storage 路徑 |
| thumbnail_path | TEXT | 縮圖路徑 |
| caption_zh | TEXT | 照片說明 |
| arrow_overlay | JSONB | 箭頭疊加 {x, y, angle, type} |
| uploaded_by | TEXT | 上傳者 ID（眾包追蹤） |
| created_at | TIMESTAMPTZ | 上傳時間（自動） |

**nav_routes（路線）**

| 欄位 | 類型 | 說明 |
| :--- | :--- | :--- |
| id | SERIAL PK | 主鍵 |
| destination_id | INTEGER FK | 目的地 |
| start_building_id | INTEGER FK | 起點建築（NULL = 校門口） |
| segment_ids | INTEGER[] | 路徑段 ID 陣列（順序） |
| total_steps | INTEGER | 總步數 |
| estimated_time | INTEGER | 預估總秒數 |
| is_accessible | BOOLEAN | 是否為無障礙路線 |
| created_at | TIMESTAMPTZ | 建立時間（自動） |
| updated_at | TIMESTAMPTZ | 更新時間（自動） |

**nav_crowdsource（眾包）**

| 欄位 | 類型 | 說明 |
| :--- | :--- | :--- |
| id | SERIAL PK | 主鍵 |
| user_id | TEXT | 貢獻者 ID |
| type | TEXT | new_photo/update_photo/report_error/new_destination |
| destination_id | INTEGER FK | 相關目的地 |
| photos | JSONB | 上傳照片資訊 |
| description | TEXT | 貢獻描述 |
| status | TEXT | pending/approved/rejected |
| reviewed_by | TEXT | 審核者 |
| reviewed_at | TIMESTAMPTZ | 審核時間 |

#### **6.1.3 搜尋功能設計**

實作 PostgreSQL 函數支援以下搜尋能力：

* **模糊匹配**：`人院` → `人文學院`、`A1` → `A100-A199`  
* **別名搜尋**：`管院` → `管理學院`、`學務` → `學生事務處`  
* **類型過濾**：只搜尋廁所/飲水機/電梯  
* **自動建議**：基於輸入前綴返回候選結果

### **6.2 照片模組化策略**

#### **6.2.1 問題分析**

原始設計每個目的地需 5-15 張照片，500+ 標的需 5000+ 張，工作量過大且難以維護。

#### **6.2.2 解決方案：路徑分段複用**

將導航路徑拆分為三層結構，透過路徑段複用大幅減少照片數量：

```
[入口層] → [樓層層] → [目的地層]
    ↓          ↓           ↓
  共用率95%  共用率80%   專屬照片
```

**範例**：導航到人文學院 A101 教室

1. **入口 → 人文學院大門**（共用路徑段 #1，複用於所有人院目的地）  
2. **人文學院大門 → 1樓樓梯口**（共用路徑段 #2，複用於1樓所有目的地）  
3. **1樓樓梯口 → A101 門口**（目的地專屬，僅 2-3 張照片）

若使用者要導航到 A102，只需替換第 3 段，前 2 段完全複用。

#### **6.2.3 路徑段分類與複用率**

| 類型 | 說明 | 照片數 | 複用率 | 預估數量 |
| :--- | :--- | :--- | :--- | :--- |
| entrance | 校門口/側門 → 校園主路 | 3-5 張 | ★★★★★ | ~10 條 |
| building_entrance | 主路 → 建築物入口 | 3-5 張 | ★★★★☆ | ~30 條 |
| floor_lobby | 建築入口 → 樓層大廳 | 2-3 張 | ★★★★☆ | ~60 條 |
| stairs | 樓梯間（上/下） | 2-3 張 | ★★★★★ | ~40 條 |
| elevator | 電梯間 | 2 張 | ★★★★★ | ~20 條 |
| corridor | 走廊段（同樓層共用） | 3-5 張 | ★★★☆☆ | ~80 條 |
| destination | 走廊 → 目的地門口 | 2-3 張 | ★☆☆☆☆ | ~200 個 |
| outdoor | 戶外景點入口/標記 | 2-3 張 | ★★★☆☆ | ~20 個 |

#### **6.2.4 照片數量估算（優化後）**

| 類型 | 計算方式 | 照片數 |
| :--- | :--- | :--- |
| 共用路徑段 | ~240 條 × 平均 4 張 | ~960 張 |
| 目的地專屬 | ~200 個 × 平均 2.5 張 | ~500 張 |
| 戶外景點 | ~20 個 × 平均 2 張 | ~40 張 |
| **總計** | | **~1,500 張** |

相較原始估算 5000+ 張（500 標的 × 10 張），減少約 **70%** 工作量。

#### **6.2.5 照片儲存規格**

* **格式**：WebP（體積小、載入快）  
* **解析度**：1280×720（橫向）或 720×1280（直向）  
* **檔案大小**：單張 ≤ 200KB，壓縮後整體 ≤ 200MB  
* **儲存位置**：Supabase Storage（整合度高，免費額度 1GB）  
* **命名規則**：`nav/{building_code}/{segment_type}/{segment_id}_{order}.webp`

#### **6.2.6 預載與離線機制**

* **預載**：當使用者瀏覽當前步驟時，自動預載下一步照片  
* **離線快取**：常用路線（如各學院入口）可快取至瀏覽器 Service Worker  
* **失敗處理**：照片載入失敗時顯示文字描述，確保導航不中斷

### **6.3 開發時程規劃**

基於一學期（18週）的開發週期，規劃以下里程碑：

| 週次 | 階段 | 主要交付項目 |
| :--- | :--- | :--- |
| W1-W2 | 規劃 | PRD 定稿、資料庫設計、UI Mockup |
| W3-W4 | 資料盤點 | 建築物/目的地清單、共用路徑段規劃、拍攝地點標記 |
| W5-W6 | 照片拍攝 | 核心路徑段拍攝（~960張）、目的地照片（~540張） |
| W7-W8 | 後端開發 | 資料庫建置、搜尋 API、路線計算 API |
| W9-W10 | 前端開發 | 搜尋介面、照片導航器、錯誤回報介面 |
| W11-W12 | 整合測試 | Alpha 測試（5-8人）、問題修正、效能優化 |
| W13-W14 | 眾包系統 | 上傳介面、審核流程、志工招募 |
| W15-W16 | Beta 測試 | 公開測試、收集回饋、迭代優化 |
| W17-W18 | 發布 | 正式上線、文件完善、交接準備 |

### **6.4 眾包貢獻流程（SOP）**

#### **6.4.1 上傳流程**

```
使用者發現缺少/錯誤
      ↓
點擊「回報問題」或「貢獻照片」
      ↓
選擇類型：錯誤回報 / 新增標的 / 更新照片
      ↓
填寫表單：目的地選擇、問題描述、上傳照片（可選）
      ↓
提交 → 自動生成工單
      ↓
貢獻者收到確認通知
```

#### **6.4.2 審核流程**

| 步驟 | 負責人 | 時間 | 動作 |
| :--- | :--- | :--- | :--- |
| 1. 自動驗證 | 系統 | 即時 | 檢查照片品質（解析度/模糊/內容安全） |
| 2. 初步審核 | 志工 | 3日內 | 確認位置正確、照片可用 |
| 3. 最終審核 | 管理員 | 7日內 | 整合至資料庫、更新路線 |
| 4. 上線通知 | 系統 | 即時 | 通知貢獻者「您的貢獻已上線」 |

#### **6.4.3 品質控制**

* **照片要求**：解析度 ≥ 1280×720、非模糊、無隱私內容
* **重複驗證**：同一標的需 ≥2 位貢獻者驗證才正式上線
* **回饋機制**：使用者可對現有照片評分，低評分自動觸發更新請求

### **6.5 前端元件規劃**

| 元件 | 路徑 | 功能說明 |
| :--- | :--- | :--- |
| `NavigationCard` | `/components/Navigation/` | Dashboard 入口卡片，顯示最近搜尋/熱門目的地 |
| `NavigationSearch` | `/components/Navigation/` | 搜尋框+自動完成+類型篩選（教室/廁所/電梯…） |
| `PhotoStepNavigator` | `/components/Navigation/` | 照片步驟導航器：照片顯示、進度條、上/下一步、箭頭動畫 |
| `RouteOverview` | `/components/Navigation/` | 路線總覽：預估時間、總步數、無障礙標記 |
| `CrowdsourceUpload` | `/components/Navigation/` | 眾包上傳：選擇標的、描述問題、多張照片上傳 |
| `AccessibilityToggle` | `/components/Navigation/` | 無障礙模式切換：優先電梯路線 |

### **6.6 後端 API 規劃**

| 端點 | 方法 | 功能 |
| :--- | :--- | :--- |
| `/api/nav/search` | GET | 搜尋目的地（支援模糊/別名/類型篩選） |
| `/api/nav/destinations/{id}` | GET | 取得單一目的地詳細資訊 |
| `/api/nav/routes` | POST | 計算從起點到目的地的路線（含無障礙選項） |
| `/api/nav/routes/{id}/steps` | GET | 取得路線的所有照片步驟 |
| `/api/nav/locations` | GET | 取得所有地點清單（建築物/戶外/景觀） |
| `/api/nav/crowdsource` | POST | 提交眾包貢獻（照片/回報） |
| `/api/nav/crowdsource/{id}/review` | PATCH | 審核眾包貢獻（管理員） |

### **6.7 無障礙設計**

#### **6.7.1 功能支援**

| 使用者類型 | 功能 | 說明 |
| :--- | :--- | :--- |
| 輪椅使用者 | 電梯優先路線 | 自動過濾無電梯路徑，標註坡道位置 |
| 輪椅使用者 | 無障礙廁所標記 | 篩選有無障礙設施的廁所 |
| 視障使用者 | 高對比模式 | 增強文字與背景對比度 |
| 視障使用者 | 螢幕閱讀器支援 | 所有照片提供 alt 文字描述 |
| 所有使用者 | 語音播報（未來） | 逐步語音導航指令 |

#### **6.7.2 資料標記**

每個目的地與路徑段包含 `is_accessible` 欄位，標記：
* 是否有電梯到達
* 是否有無障礙坡道
* 門寬是否足夠輪椅通過

## **7\. KPI與成功指標**

對應計畫書量化目標，基於問卷基準，並新增覆蓋率追蹤全面性：

| KPI類別 | 指標 | 定義 | 目標 | 測量方式 |
| ----- | ----- | ----- | ----- | ----- |
| 到達效率 | 導航完成率 | 任務完成比例（走完照片步驟） | ≥75% | 原型測試成功率 |
| 到達效率 | 平均到達時間 | 中位數耗時（含多標的） | ≤步行預期+20% | 測試計時 |
| 資訊詳細度 | 體驗評分/NPS | 滿意度/推薦值 | NPS≥7 | SUS問卷與NPS |
| 資訊詳細度 | 教室/標的識別率 | 正確識別比例（照片+文字） | ≥90% | 測試任務準確度（教室/設施） |
| 資訊詳細度 | 步驟前進完成率 | 完整走完步驟比例（≥80%步數） | ≥80% | 後台點擊追蹤 |
| 導航可靠度 | 步驟切換順暢率 | 照片載入失敗次數/步驟 | ≤0.5次/路線 | 事件追蹤 |
| 導航可靠度 | 錯誤回報率 | 14日修正率（含眾包標的） | ≥80% | 後台審核 |
| 整體 | 功能啟用率 | 使用占比 | ≥50% | Analytics |
| 整體 | 留存率 | 2週重返 | ≥60% | 會話追蹤 |
| 整體 | 標的覆蓋率 | 支援查詢標的比例 | ≥80% | 後台資料庫統計（教室/設施等） |

驗證方法：第11週Alpha測試擴充標的任務（e.g., "導航到廁所"，5-8位受測者）；Beta監測覆蓋率（依眾包成長）。

## **8\. 依賴與風險**

* **依賴**：Google Maps Embed（免費 iframe 嵌入，室外導航）；Supabase PostgreSQL + Storage（資料庫與照片儲存，初始500+標的、59個地點）；眾包工具（上傳表單，審核腳本）；校園盤點（訪談9位+志工拍攝，涵蓋電梯/樓梯等）。  
* **風險**：  
  * 初始覆蓋不足（緩解：MVP優先教室/設施80%，眾包補全；SOP每月新增50標的）。  
  * 眾包品質低（緩解：AI初步驗證+手審，意願提升至\>3/5）。  
  * 儲存膨脹（緩解：壓縮照片，\<1MB/標的；雲端限制內）。  
  * 隱私爭議（緩解：明確同意書，倫理檢點；公共區拍攝/匿名上傳）。  
* **假設**：80%查詢為常見標的（教室/廁所）；眾包可貢獻20%擴充（基於回報率）。

## **9\. 附錄**

### **9.1 地點代碼對照表**

| 代碼 | 中文名稱 | 英文名稱 | 樓層 | 電梯 | 備註 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **學院建築** |||||
| HUM | 人文學院 | College of Humanities | 4 | ✓ | |
| MGT | 管理學院 | College of Management | B1+5 | ✓ | 含地下一層 |
| SCI-A | 科技學院 A 棟 | Science Building A | 5 | ✓ | 資工系、資管系 |
| SCI-B | 科技學院 B 棟 | Science Building B | 5 | ✓ | 電機系 |
| SCI-C | 科技學院 C 棟 | Science Building C | 5 | ✓ | 土木系 |
| SCI-D | 科技學院 D 棟 | Science Building D | 5 | ✓ | 應化系 |
| EDU | 教育學院 | College of Education | 4 | ✓ | |
| NUR | 護理暨健康福祉學院 | College of Nursing and Health Care | 4 | ✓ | |
| **行政與教學** |||||
| ADM | 行政大樓 | Administration Building | 4 | ✓ | |
| LIB | 圖書館 | Library | B1+5 | ✓ | 含地下一層 |
| TCH | 綜合教學大樓 | General Teaching Building | 4 | ✓ | |
| **學生生活** |||||
| GYM | 體健中心 | Physical Education Center | 3 | ✓ | 含游泳池、健身房 |
| STU | 學生活動中心 | Student Activity Center | 4 | ✓ | 含演藝廳 |
| DRM-A | 學生宿舍 A棟 | Dormitory A (誠樸樓) | 5 | ✓ | 女生宿舍 |
| DRM-B | 學生宿舍 B棟 | Dormitory B (弘毅樓) | 5 | ✓ | 女生宿舍 |
| DRM-C | 學生宿舍 C棟 | Dormitory C (務本樓) | 5 | ✓ | 男生宿舍 |
| DRM-D | 學生宿舍 D棟 | Dormitory D (致用樓) | 5 | ✓ | 男生宿舍 |
| GRD-E | 研究生宿舍 E棟 | Graduate Dorm E (桃苑) | B1+5 | ✓ | |
| GRD-F | 研究生宿舍 F棟 | Graduate Dorm F (嵐莊) | B1+5 | ✓ | |
| GUH | 暨大會館 | NCNU Guest House | 3 | ✓ | 住宿設施 |
| STH | 學生會館 | Student Hall | 2 | ✗ | |
| FAC | 學人宿舍 | Faculty Housing | 3 | ✗ | 教職員宿舍 |
| CAF | 學生餐廳 | Student Cafeteria | 2 | ✗ | |
| **劇場與表演** |||||
| SQR | 方形劇場 | Square Theater | 1 | ✗ | 可容納 396 人 |
| CIR | 圓形劇場 | Circular Theater | 1 | ✗ | 戶外表演場地 |
| OAT | 人院戶外劇場 | Humanities Outdoor Theater | 1 | ✗ | |
| **入口與警衛** |||||
| GTM | 校門口警衛室 | Main Gate Security | 1 | ✗ | |
| GTP | 桃米警衛室 | Taomi Gate Security | 1 | ✗ | |
| **戶外場地** |||||
| TRK | 操場 | Track and Field | — | — | 田徑場 |
| SBF | 壘球場 | Softball Field | — | — | |
| TNS | 網球場 | Tennis Courts | — | — | |
| BBL | 籃球場 | Basketball Courts | — | — | |
| GLF | 高爾夫練習場 | Golf Practice Range | — | — | |
| **景觀區域** |||||
| SNP | 日池 | Sun Pond | — | — | |
| MNP | 月池 | Moon Pond | — | — | |
| MLN | 大草坪 | Main Lawn | — | — | 管院前方 |
| SLN | 科院大草坪 | Science College Lawn | — | — | |
| VGT | 梵谷步道 | Van Gogh Trail | — | — | |
| CHR | 櫻花區 | Cherry Blossom Area | — | — | |
| MPL | 楓樹區 | Maple Area | — | — | |
| TGR | 台灣欒樹道 | Taiwan Golden Rain Tree Road | — | — | |
| STD | 勵學坡 | Study Slope | — | — | 圖書館與行政大樓間 |
| **服務設施** |||||
| PST | 郵局 | Post Office | 1 | ✗ | |
| CPY | 影印室 | Copy Center | 1 | ✗ | |
| MED | 醫療中心 | Health Center | 1 | ✗ | |
| CVS-CAF | 全家（學餐店） | FamilyMart (Cafeteria) | 1 | ✗ | 學生餐廳內 |
| CVS-HUM | 全家（人院店） | FamilyMart (Humanities) | 1 | ✗ | 人文學院 |
| **停車場** |||||
| PK-HUM | 人文學院停車場 | Humanities Parking | — | — | |
| PK-MGT | 管理學院停車場 | Management Parking | — | — | |
| PK-SCI | 科技學院停車場 | Science Parking | — | — | |
| PK-EDU | 教育學院停車場 | Education Parking | — | — | |
| PK-LIB | 圖書館停車場 | Library Parking | — | — | |
| PK-GYM | 體健中心停車場 | Gym Parking | — | — | |

### **9.2 目的地類型代碼**

| 類型代碼 | 中文 | 說明 |
| :--- | :--- | :--- |
| `classroom` | 教室 | 一般教室、階梯教室、演講廳 |
| `office` | 辦公室 | 行政單位、教師辦公室 |
| `restroom` | 廁所 | 男廁/女廁/無障礙廁所 |
| `elevator` | 電梯 | 電梯入口 |
| `stairs` | 樓梯 | 樓梯間 |
| `water` | 飲水機 | 飲水機位置 |
| `theater` | 劇場 | 方形劇場、圓形劇場、戶外劇場 |
| `cafeteria` | 餐廳 | 學生餐廳、教職員餐廳 |
| `store` | 商店 | 便利商店、販賣機 |
| `atm` | ATM | 提款機位置 |
| `library` | 圖書館 | 圖書館各樓層入口 |
| `dorm` | 宿舍 | 宿舍各棟入口 |
| `parking` | 停車場 | 機車/汽車停車場 |
| `entrance` | 入口 | 校門口、建築物主入口 |
| `outdoor` | 戶外場地 | 操場、球場、步道等 |
| `landscape` | 景觀區域 | 池塘、草坪、花園等 |
| `post_office` | 郵局 | 郵局服務 |
| `copy_center` | 影印室 | 影印/列印服務 |
| `health_center` | 醫療中心 | 校園醫療服務 |
| `other` | 其他 | 未分類的其他設施 |

### **9.3 資料範例（JSON 格式）**

#### **9.3.1 地點資料（nav_locations）**

**建築物類型**
```json
{
  "id": 1,
  "code": "HUM",
  "name_zh": "人文學院",
  "name_en": "College of Humanities",
  "aliases": ["人院", "人文"],
  "location": {"lat": 23.9574, "lng": 120.9287},
  "floors": 4,
  "has_elevator": true,
  "location_type": "building",
  "created_at": "2025-01-15T08:00:00Z",
  "updated_at": "2025-01-15T08:00:00Z"
}
```

**戶外場地類型**
```json
{
  "id": 35,
  "code": "TRK",
  "name_zh": "操場",
  "name_en": "Track and Field",
  "aliases": ["田徑場", "跑道"],
  "location": {"lat": 23.9580, "lng": 120.9300},
  "floors": null,
  "has_elevator": null,
  "location_type": "outdoor",
  "created_at": "2025-01-15T08:00:00Z",
  "updated_at": "2025-01-15T08:00:00Z"
}
```

**景觀區域類型**
```json
{
  "id": 40,
  "code": "SNP",
  "name_zh": "日池",
  "name_en": "Sun Pond",
  "aliases": ["太陽池"],
  "location": {"lat": 23.9568, "lng": 120.9295},
  "floors": null,
  "has_elevator": null,
  "location_type": "landscape",
  "created_at": "2025-01-15T08:00:00Z",
  "updated_at": "2025-01-15T08:00:00Z"
}
```

#### **9.3.2 目的地資料（nav_destinations）**

```json
{
  "id": 101,
  "location_id": 1,
  "type": "classroom",
  "code": "A101",
  "name_zh": "A101 教室",
  "name_en": "Room A101",
  "floor": 1,
  "aliases": ["人院101", "A1"],
  "tags": ["大教室", "投影設備", "冷氣"],
  "is_accessible": true,
  "created_at": "2025-01-15T08:00:00Z",
  "updated_at": "2025-01-15T08:00:00Z"
}
```

#### **9.3.3 路徑段資料（nav_path_segments）**

```json
{
  "id": 1,
  "location_id": 1,
  "segment_type": "entrance",
  "start_node": "CAMPUS_MAIN_GATE",
  "end_node": "HUM_ENTRANCE",
  "description_zh": "從校門口走向人文學院正門",
  "floor": 1,
  "direction": "horizontal",
  "estimated_time": 180,
  "is_accessible": true,
  "created_at": "2025-01-15T08:00:00Z",
  "updated_at": "2025-01-15T08:00:00Z"
}
```

#### **9.3.4 API 回應格式**

**搜尋結果 `/api/nav/search?q=人院`**
```json
{
  "success": true,
  "data": {
    "locations": [
      {"id": 1, "code": "HUM", "name_zh": "人文學院", "type": "building"}
    ],
    "destinations": [
      {"id": 101, "code": "A101", "name_zh": "A101 教室", "type": "classroom", "location_name": "人文學院"},
      {"id": 102, "code": "A102", "name_zh": "A102 教室", "type": "classroom", "location_name": "人文學院"}
    ]
  },
  "meta": {
    "total": 3,
    "query": "人院",
    "response_time_ms": 45
  }
}
```

**路線計算結果 `/api/nav/routes`**
```json
{
  "success": true,
  "data": {
    "destination": {
      "id": 101,
      "name_zh": "A101 教室",
      "location_name": "人文學院",
      "floor": 1
    },
    "route": {
      "total_steps": 8,
      "estimated_time": 180,
      "is_accessible": true,
      "segments": [
        {"id": 1, "type": "entrance", "description": "從校門口走向人文學院正門"},
        {"id": 5, "type": "floor_lobby", "description": "進入人文學院大廳"},
        {"id": 12, "type": "destination", "description": "A101 教室在右手邊"}
      ]
    },
    "photos": [
      {"step": 1, "url": "/storage/nav/HUM/entrance/1_1.webp", "caption": "校門口往人文學院方向"},
      {"step": 2, "url": "/storage/nav/HUM/entrance/1_2.webp", "caption": "沿著主環道前進"}
    ]
  }
}
```

**地點清單 `/api/nav/locations?type=building`**
```json
{
  "success": true,
  "data": [
    {"id": 1, "code": "HUM", "name_zh": "人文學院", "floors": 4, "has_elevator": true},
    {"id": 2, "code": "MGT", "name_zh": "管理學院", "floors": 5, "has_elevator": true},
    {"id": 3, "code": "SCI-A", "name_zh": "科技學院 A 棟", "floors": 5, "has_elevator": true}
  ],
  "meta": {
    "total": 59,
    "type_filter": "building"
  }
}
```

### **9.4 標的清單樣本**

基於問卷分析，MVP 優先覆蓋以下 12 類標的：

1. **教室**：A100-A510、B100-B410、C100-C310...（所有編號）
2. **辦公室**：教務處、學務處、總務處、研發處、各系辦公室
3. **廁所**：每建築每樓層 1-2 組（含無障礙廁所標記）
4. **飲水機**：每建築每樓層 1-2 處
5. **電梯**：所有有電梯的建築
6. **樓梯**：主要樓梯間
7. **劇場**：方形劇場、圓形劇場
8. **圖書館**：各樓層入口
9. **餐廳**：學生餐廳、教職員餐廳
10. **便利商店**：7-11、全家
11. **ATM**：各建築 ATM 位置
12. **其他**：郵局、影印室、醫療中心
13. **戶外場地**：操場、壘球場、網球場、籃球場、高爾夫練習場
14. **景觀區域**：日池、月池、大草坪、梵谷步道、櫻花區、楓樹區

### **9.5 使用者旅程圖**

```
┌─────────────────────┐
│ 1. 開啟導航功能      │
│    (從 Dashboard)   │
└──────────┬──────────┘
           ↓
┌─────────────────────┐
│ 2. 搜尋目的地        │
│    輸入: "A101"     │
│    或: "廁所"       │
└──────────┬──────────┘
           ↓
┌─────────────────────┐
│ 3. 選擇結果          │
│    顯示: 建築/樓層   │
│    標記: 預估時間    │
└──────────┬──────────┘
           ↓
╔═════════════════════╗
║ 4. 室外導航          ║
║ ┌─────────────────┐ ║
║ │ Google Maps     │ ║
║ │ Embed (iframe)  │ ║
║ │ 顯示步行路線    │ ║
║ └─────────────────┘ ║
║ [已到達建築物？]     ║
║ [  開始室內導航  ]   ║
╚══════════┬══════════╝
           ↓
╔═════════════════════╗
║ 5. 室內照片導航      ║
║    步驟 1/8: 入口   ║
║    [照片+箭頭]      ║
║    "往左轉..."      ║
║    [上一步] [下一步] ║
╚══════════┬══════════╝
           ↓
┌─────────────────────┐
│ 6. 到達目的地        │
│    顯示: 完成畫面   │
│    選項: 回報問題   │
│          評價體驗   │
└─────────────────────┘
```

**導航流程說明**：
1. **室外導航**：使用 Google Maps Embed（免費 iframe）顯示從校門口到目標建築物的步行路線
2. **切換時機**：使用者到達建築物入口後，點擊「開始室內導航」按鈕
3. **室內導航**：照片步驟導航（Street View 式），從建築物入口引導至最終目的地

### **9.6 K/S/A對應**

| 能力 | 說明 | 本專案對應 |
| :--- | :--- | :--- |
| Knowledge | 知識 | 全面痛點分析（問卷 82 份）、使用者需求分析 |
| Skill | 技能 | 資料庫設計、API 開發、眾包機制規劃 |
| Attitude | 態度 | 包容所有使用者需求、資源優化（推薦意願 8.82/10） |

### **9.7 參考資料**

* 問卷 Top 痛點清單（教室 34.15%、設施 10%）
* PMMC 學程指南
* 現有網站：[https://ncnu-super-assistant.vercel.app](https://ncnu-super-assistant.vercel.app)
* Supabase 文件：[https://supabase.com/docs](https://supabase.com/docs)

---

此 PRD v1.4 定稿，包含完整技術設計（資料庫 6 張表含時間戳記、照片模組化策略）、開發時程（18週）、眾包 SOP、前端元件/後端 API 規劃與無障礙設計。將作為原型設計與內容盤點輸入，歡迎指導老師回饋修改。
