<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" class="logo" width="120"/>

# ğŸ“‹ ç¨‹å¼ç¢¼åˆ†æ®µè™•ç†å·¥å…·åŒ…

é€™å€‹å·¥å…·åŒ…å¯ä»¥å¹«æ‚¨å°‡ä»»ä½•éé•·çš„ç¨‹å¼ç¢¼æª”æ¡ˆå®‰å…¨åœ°åˆ†å‰²æˆå°æ®µï¼Œæ–¹ä¾¿èˆ‡AIäº’å‹•ï¼Œå®Œå…¨ä¸å½±éŸ¿åŸå§‹æª”æ¡ˆçš„åŠŸèƒ½ã€‚

## ğŸ› ï¸ é€šç”¨åˆ†æ®µè…³æœ¬

### ä¸»è¦è…³æœ¬ï¼š`code_splitter.py`

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
é€šç”¨ç¨‹å¼ç¢¼åˆ†æ®µè™•ç†å·¥å…·
é©ç”¨æ–¼æ‰€æœ‰é¡å‹çš„ç¨‹å¼ç¢¼æª”æ¡ˆï¼šCSS, JS, HTML, JSON, Python, Javaç­‰
å®Œå…¨ä¸ä¿®æ”¹åŸå§‹å…§å®¹ï¼Œåªé€²è¡Œç‰©ç†åˆ†å‰²
"""

import os
import sys
import argparse
from datetime import datetime
import json

class CodeSplitter:
    def __init__(self, input_file, lines_per_chunk=400, output_dir=None):
        self.input_file = input_file
        self.lines_per_chunk = lines_per_chunk
        self.output_dir = output_dir or f"split_{self.get_base_name()}"
        self.file_extension = os.path.splitext(input_file)[1]
        self.base_name = self.get_base_name()
        
    def get_base_name(self):
        """ç²å–ä¸å«è·¯å¾‘å’Œå‰¯æª”åçš„æª”æ¡ˆå"""
        return os.path.splitext(os.path.basename(self.input_file))[0]
    
    def create_output_directory(self):
        """å‰µå»ºè¼¸å‡ºç›®éŒ„"""
        if not os.path.exists(self.output_dir):
            os.makedirs(self.output_dir)
            print(f"âœ… å·²å‰µå»ºè¼¸å‡ºç›®éŒ„: {self.output_dir}")
        else:
            print(f"ğŸ“ ä½¿ç”¨ç¾æœ‰ç›®éŒ„: {self.output_dir}")
    
    def read_file(self):
        """è®€å–åŸå§‹æª”æ¡ˆ"""
        try:
            with open(self.input_file, 'r', encoding='utf-8') as f:
                lines = f.readlines()
            return lines
        except UnicodeDecodeError:
            # å˜—è©¦å…¶ä»–ç·¨ç¢¼
            try:
                with open(self.input_file, 'r', encoding='gbk') as f:
                    lines = f.readlines()
                print("âš ï¸ ä½¿ç”¨ GBK ç·¨ç¢¼è®€å–æª”æ¡ˆ")
                return lines
            except:
                with open(self.input_file, 'r', encoding='latin-1') as f:
                    lines = f.readlines()
                print("âš ï¸ ä½¿ç”¨ Latin-1 ç·¨ç¢¼è®€å–æª”æ¡ˆ")
                return lines
    
    def split_file(self):
        """åˆ†å‰²æª”æ¡ˆ"""
        print(f"ğŸ”§ é–‹å§‹åˆ†å‰²æª”æ¡ˆ: {self.input_file}")
        
        lines = self.read_file()
        total_lines = len(lines)
        
        if total_lines <= self.lines_per_chunk:
            print(f"âš ï¸ æª”æ¡ˆåªæœ‰ {total_lines} è¡Œï¼Œç„¡éœ€åˆ†å‰²")
            return []
        
        self.create_output_directory()
        
        chunk_files = []
        chunk_num = 1
        
        for i in range(0, total_lines, self.lines_per_chunk):
            chunk_lines = lines[i:i + self.lines_per_chunk]
            
            # ç”Ÿæˆåˆ†æ®µæª”æ¡ˆå
            chunk_filename = f"{self.base_name}_part_{chunk_num:02d}{self.file_extension}"
            chunk_path = os.path.join(self.output_dir, chunk_filename)
            
            # å¯«å…¥åˆ†æ®µæª”æ¡ˆ
            with open(chunk_path, 'w', encoding='utf-8') as f:
                f.writelines(chunk_lines)
            
            chunk_info = {
                'filename': chunk_filename,
                'path': chunk_path,
                'lines': len(chunk_lines),
                'start_line': i + 1,
                'end_line': i + len(chunk_lines)
            }
            chunk_files.append(chunk_info)
            
            print(f"ğŸ“„ å·²å‰µå»º: {chunk_filename} (ç¬¬ {i+1}-{i+len(chunk_lines)} è¡Œï¼Œå…± {len(chunk_lines)} è¡Œ)")
            chunk_num += 1
        
        return chunk_files
    
    def generate_summary(self, chunk_files):
        """ç”Ÿæˆåˆ†å‰²æ‘˜è¦æª”æ¡ˆ"""
        summary = {
            'original_file': self.input_file,
            'total_lines': sum(chunk['lines'] for chunk in chunk_files),
            'chunks_count': len(chunk_files),
            'lines_per_chunk': self.lines_per_chunk,
            'split_time': datetime.now().isoformat(),
            'chunks': chunk_files
        }
        
        summary_path = os.path.join(self.output_dir, f"{self.base_name}_split_summary.json")
        with open(summary_path, 'w', encoding='utf-8') as f:
            json.dump(summary, f, indent=2, ensure_ascii=False)
        
        print(f"ğŸ“Š å·²ç”Ÿæˆæ‘˜è¦æª”æ¡ˆ: {summary_path}")
        return summary_path
    
    def generate_readme(self, chunk_files):
        """ç”Ÿæˆèªªæ˜æª”æ¡ˆ"""
        readme_content = f"""# {self.base_name} åˆ†æ®µè™•ç†èªªæ˜

## ğŸ“‹ åŸºæœ¬è³‡è¨Š
- **åŸå§‹æª”æ¡ˆ**: `{self.input_file}`
- **ç¸½è¡Œæ•¸**: {sum(chunk['lines'] for chunk in chunk_files)} è¡Œ
- **åˆ†æ®µæ•¸é‡**: {len(chunk_files)} å€‹
- **æ¯æ®µå¤§å°**: ç´„ {self.lines_per_chunk} è¡Œ
- **åˆ†å‰²æ™‚é–“**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

## ğŸ“ åˆ†æ®µæª”æ¡ˆæ¸…å–®

| æª”æ¡ˆå | è¡Œæ•¸ç¯„åœ | è¡Œæ•¸ |
|--------|----------|------|
"""
        for chunk in chunk_files:
            readme_content += f"| `{chunk['filename']}` | {chunk['start_line']}-{chunk['end_line']} | {chunk['lines']} |\n"
        
        readme_content += f"""
## ğŸ¤– AI äº’å‹•å»ºè­°

### 1. é€å€‹æª”æ¡ˆè™•ç†
```

è«‹åˆ†æä»¥ä¸‹ç¨‹å¼ç¢¼ç‰‡æ®µï¼ˆä¾†è‡ª {self.base_name}ï¼Œç¬¬ X-Y è¡Œï¼‰ï¼š
[è²¼ä¸Šåˆ†æ®µæª”æ¡ˆå…§å®¹]

```

### 2. èªªæ˜æª”æ¡ˆä¾†æº
ç‚ºäº†è®“ AI æ›´å¥½ç†è§£ä¸Šä¸‹æ–‡ï¼Œè«‹åœ¨æ¯æ¬¡æå•æ™‚èªªæ˜ï¼š
- é€™æ˜¯ä¾†è‡ªå“ªå€‹åŸå§‹æª”æ¡ˆçš„ç¬¬å¹¾æ®µ
- æª”æ¡ˆçš„æ•´é«”åŠŸèƒ½å’Œç”¨é€”
- éœ€è¦ AI å”åŠ©çš„å…·é«”å•é¡Œ

### 3. é‡çµ„å»ºè­°
è™•ç†å®Œæ‰€æœ‰åˆ†æ®µå¾Œï¼Œå¯ä»¥è¦æ±‚ AI å”åŠ©é‡çµ„å„ªåŒ–å¾Œçš„ç¨‹å¼ç¢¼ã€‚

## âš ï¸ æ³¨æ„äº‹é …
- åŸå§‹æª”æ¡ˆ `{self.input_file}` å®Œå…¨æœªè¢«ä¿®æ”¹
- æ‰€æœ‰åˆ†æ®µæª”æ¡ˆåƒ…ä¾›åˆ†æä½¿ç”¨
- å¦‚éœ€æ‡‰ç”¨ä¿®æ”¹ï¼Œè«‹å…ˆå‚™ä»½åŸå§‹æª”æ¡ˆ
"""
        
        readme_path = os.path.join(self.output_dir, "README.md")
        with open(readme_path, 'w', encoding='utf-8') as f:
            f.write(readme_content)
        
        print(f"ğŸ“– å·²ç”Ÿæˆèªªæ˜æª”æ¡ˆ: {readme_path}")
        return readme_path

def main():
    parser = argparse.ArgumentParser(description='é€šç”¨ç¨‹å¼ç¢¼åˆ†æ®µè™•ç†å·¥å…·')
    parser.add_argument('input_file', help='è¦åˆ†å‰²çš„æª”æ¡ˆè·¯å¾‘')
    parser.add_argument('-l', '--lines', type=int, default=400, 
                       help='æ¯æ®µçš„è¡Œæ•¸ (é»˜èª: 400)')
    parser.add_argument('-o', '--output', help='è¼¸å‡ºç›®éŒ„ (é»˜èª: split_æª”æ¡ˆå)')
    
    args = parser.parse_args()
    
    # æª¢æŸ¥è¼¸å…¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨
    if not os.path.exists(args.input_file):
        print(f"âŒ éŒ¯èª¤: æ‰¾ä¸åˆ°æª”æ¡ˆ '{args.input_file}'")
        sys.exit(1)
    
    # åŸ·è¡Œåˆ†å‰²
    splitter = CodeSplitter(args.input_file, args.lines, args.output)
    
    try:
        chunk_files = splitter.split_file()
        
        if chunk_files:
            splitter.generate_summary(chunk_files)
            splitter.generate_readme(chunk_files)
            
            print(f"\nğŸ‰ åˆ†å‰²å®Œæˆ!")
            print(f"ğŸ“ è¼¸å‡ºç›®éŒ„: {splitter.output_dir}")
            print(f"ğŸ“„ åˆ†æ®µæ•¸é‡: {len(chunk_files)}")
            print(f"ğŸ’¡ è«‹æŸ¥çœ‹ README.md äº†è§£å¦‚ä½•ä½¿ç”¨åˆ†æ®µæª”æ¡ˆ")
        
    except Exception as e:
        print(f"âŒ åˆ†å‰²éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤: {e}")
        sys.exit(1)

if __name__ == '__main__':
    main()
```


## ğŸ“– æ“ä½œæ‰‹å†Š

### ğŸš€ å¿«é€Ÿé–‹å§‹

#### 1. åŸºæœ¬ä½¿ç”¨

```bash
# åˆ†å‰² CSS æª”æ¡ˆï¼ˆé»˜èªæ¯æ®µ 400 è¡Œï¼‰
python code_splitter.py Dashboard.css

# åˆ†å‰² JavaScript æª”æ¡ˆï¼Œæ¯æ®µ 300 è¡Œ
python code_splitter.py main.js -l 300

# æŒ‡å®šè¼¸å‡ºç›®éŒ„
python code_splitter.py data.json -o my_output_folder
```


#### 2. å¸¸è¦‹æª”æ¡ˆé¡å‹çš„å»ºè­°è¨­å®š

| æª”æ¡ˆé¡å‹ | å»ºè­°æ¯æ®µè¡Œæ•¸ | æŒ‡ä»¤ç¯„ä¾‹ |
| :-- | :-- | :-- |
| CSS | 400-500 | `python code_splitter.py style.css -l 450` |
| JavaScript | 300-400 | `python code_splitter.py app.js -l 350` |
| HTML | 200-300 | `python code_splitter.py index.html -l 250` |
| JSON | 100-200 | `python code_splitter.py data.json -l 150` |
| Python | 200-300 | `python code_splitter.py main.py -l 250` |

### ğŸ“ è¼¸å‡ºçµæ§‹

åŸ·è¡Œå¾Œæœƒç”Ÿæˆä»¥ä¸‹çµæ§‹ï¼š

```
split_Dashboard/
â”œâ”€â”€ Dashboard_part_01.css    # ç¬¬ 1-400 è¡Œ
â”œâ”€â”€ Dashboard_part_02.css    # ç¬¬ 401-800 è¡Œ
â”œâ”€â”€ Dashboard_part_03.css    # ç¬¬ 801-1200 è¡Œ
â”œâ”€â”€ ...
â”œâ”€â”€ Dashboard_split_summary.json  # åˆ†å‰²æ‘˜è¦ï¼ˆæ©Ÿå™¨å¯è®€ï¼‰
â””â”€â”€ README.md                     # ä½¿ç”¨èªªæ˜ï¼ˆäººé¡å¯è®€ï¼‰
```


### ğŸ¤– èˆ‡ AI äº’å‹•çš„æœ€ä½³å¯¦è¸

#### 1. æå•æ¨¡æ¿

```markdown
# çµ¦ AI çš„æ¨™æº–æå•æ ¼å¼

**æª”æ¡ˆè³‡è¨Š**: Dashboard.css ç¬¬ 801-1200 è¡Œï¼ˆå…± 3200 è¡Œä¸­çš„ç¬¬ 3 æ®µï¼‰
**æª”æ¡ˆåŠŸèƒ½**: ç¶²ç«™å„€è¡¨æ¿çš„æ¨£å¼è¡¨ï¼ŒåŒ…å«ç‹€æ…‹å¡ç‰‡ã€æ¯›ç»ç’ƒæ•ˆæœç­‰

**è«‹å”åŠ©**: [å…·é«”å•é¡Œï¼Œå¦‚ï¼šé‡æ§‹ã€å„ªåŒ–ã€é™¤éŒ¯ç­‰]

**ç¨‹å¼ç¢¼**:
```

[è²¼ä¸Šåˆ†æ®µæª”æ¡ˆå…§å®¹]

```
```


#### 2. åˆ†æç­–ç•¥

- **ç¬¬ä¸€è¼ª**: é€æ®µäº†è§£åŠŸèƒ½å’Œçµæ§‹
- **ç¬¬äºŒè¼ª**: è­˜åˆ¥å•é¡Œå’Œæ”¹é€²é»
- **ç¬¬ä¸‰è¼ª**: ç²å–å…·é«”çš„ä¿®æ”¹å»ºè­°
- **ç¬¬å››è¼ª**: è¨è«–é‡çµ„å’Œæ•´åˆæ–¹æ¡ˆ


### ğŸ”§ é€²éšåŠŸèƒ½è…³æœ¬

#### æª”æ¡ˆé‡çµ„è…³æœ¬ï¼š`code_merger.py`

```python
#!/usr/bin/env python3
"""
å°‡åˆ†æ®µè™•ç†å¾Œçš„æª”æ¡ˆé‡æ–°åˆä½µ
ç”¨æ–¼æ‡‰ç”¨ AI å»ºè­°çš„ä¿®æ”¹
"""

import os
import json
import glob

def merge_split_files(split_dir):
    """åˆä½µåˆ†æ®µæª”æ¡ˆ"""
    
    # è®€å–æ‘˜è¦æª”æ¡ˆ
    summary_files = glob.glob(os.path.join(split_dir, "*_split_summary.json"))
    if not summary_files:
        print("âŒ æ‰¾ä¸åˆ°åˆ†å‰²æ‘˜è¦æª”æ¡ˆ")
        return
    
    with open(summary_files[0], 'r', encoding='utf-8') as f:
        summary = json.load(f)
    
    # æ‰¾åˆ°æ‰€æœ‰åˆ†æ®µæª”æ¡ˆ
    base_name = os.path.splitext(os.path.basename(summary['original_file']))[0]
    extension = os.path.splitext(summary['original_file'])[1]
    
    pattern = os.path.join(split_dir, f"{base_name}_part_*{extension}")
    chunk_files = sorted(glob.glob(pattern))
    
    if not chunk_files:
        print("âŒ æ‰¾ä¸åˆ°åˆ†æ®µæª”æ¡ˆ")
        return
    
    # åˆä½µå…§å®¹
    merged_content = ""
    for chunk_file in chunk_files:
        with open(chunk_file, 'r', encoding='utf-8') as f:
            merged_content += f.read()
    
    # ç”Ÿæˆåˆä½µå¾Œçš„æª”æ¡ˆ
    merged_filename = f"{base_name}_merged{extension}"
    merged_path = os.path.join(split_dir, merged_filename)
    
    with open(merged_path, 'w', encoding='utf-8') as f:
        f.write(merged_content)
    
    print(f"âœ… å·²ç”Ÿæˆåˆä½µæª”æ¡ˆ: {merged_path}")
    print(f"ğŸ“Š ç¸½è¡Œæ•¸: {merged_content.count(chr(10)) + 1}")

if __name__ == '__main__':
    import sys
    if len(sys.argv) != 2:
        print("ä½¿ç”¨æ–¹æ³•: python code_merger.py <åˆ†æ®µç›®éŒ„>")
        sys.exit(1)
    
    merge_split_files(sys.argv[1])
```


### ğŸ¯ ä½¿ç”¨å ´æ™¯ç¯„ä¾‹

#### å ´æ™¯ 1ï¼šåˆ†æå¤§å‹ CSS æª”æ¡ˆ

```bash
# 1. åˆ†å‰²æª”æ¡ˆ
python code_splitter.py Dashboard.css -l 400

# 2. èˆ‡ AI é€æ®µåˆ†æ
# ï¼ˆä½¿ç”¨ç”Ÿæˆçš„åˆ†æ®µæª”æ¡ˆèˆ‡ AI äº’å‹•ï¼‰

# 3. å¦‚éœ€åˆä½µä¿®æ”¹å¾Œçš„æª”æ¡ˆ
python code_merger.py split_Dashboard
```


#### å ´æ™¯ 2ï¼šè™•ç†è¤‡é›œçš„ JavaScript å°ˆæ¡ˆ

```bash
# åˆ†å‰²ä¸»è¦æª”æ¡ˆ
python code_splitter.py main.js -l 300 -o js_analysis

# åˆ†å‰²å·¥å…·æª”æ¡ˆ  
python code_splitter.py utils.js -l 200 -o js_analysis
```


### âš ï¸ æ•…éšœæ’é™¤

#### å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

| å•é¡Œ | è§£æ±ºæ–¹æ¡ˆ |
| :-- | :-- |
| ç·¨ç¢¼éŒ¯èª¤ | è…³æœ¬æœƒè‡ªå‹•å˜—è©¦ UTF-8ã€GBKã€Latin-1 ç·¨ç¢¼ |
| æ¬Šé™ä¸è¶³ | ç¢ºä¿æœ‰å¯«å…¥æ¬Šé™ï¼Œæˆ–ä½¿ç”¨ `sudo`ï¼ˆLinux/Macï¼‰ |
| æª”æ¡ˆéå° | å°æ–¼è¨­å®šè¡Œæ•¸çš„æª”æ¡ˆä¸æœƒåˆ†å‰²ï¼Œæœƒçµ¦å‡ºæç¤º |
| è¼¸å‡ºç›®éŒ„è¡çª | ä½¿ç”¨ `-o` åƒæ•¸æŒ‡å®šä¸åŒçš„è¼¸å‡ºç›®éŒ„ |

#### æª¢æŸ¥è…³æœ¬ï¼š`check_splitter.py`

```python
#!/usr/bin/env python3
"""
æª¢æŸ¥åˆ†æ®µè™•ç†å·¥å…·çš„ç’°å¢ƒå’Œä¾è³´
"""

import os
import sys

def check_environment():
    """æª¢æŸ¥åŸ·è¡Œç’°å¢ƒ"""
    print("ğŸ” æª¢æŸ¥åŸ·è¡Œç’°å¢ƒ...")
    
    # æª¢æŸ¥ Python ç‰ˆæœ¬
    if sys.version_info < (3, 6):
        print("âŒ éœ€è¦ Python 3.6 æˆ–æ›´æ–°ç‰ˆæœ¬")
        return False
    else:
        print(f"âœ… Python ç‰ˆæœ¬: {sys.version}")
    
    # æª¢æŸ¥å¿…è¦æ¨¡çµ„
    required_modules = ['os', 'sys', 'argparse', 'datetime', 'json', 'glob']
    for module in required_modules:
        try:
            __import__(module)
            print(f"âœ… æ¨¡çµ„ {module}: å¯ç”¨")
        except ImportError:
            print(f"âŒ æ¨¡çµ„ {module}: ç¼ºå¤±")
            return False
    
    print("ğŸ‰ ç’°å¢ƒæª¢æŸ¥é€šéï¼")
    return True

if __name__ == '__main__':
    check_environment()
```


### ğŸ’¡ Pro Tips

#### 1. æ‰¹æ¬¡è™•ç†

```bash
# è™•ç†å¤šå€‹æª”æ¡ˆçš„æ‰¹æ¬¡è…³æœ¬ï¼ˆWindows .batï¼‰
@echo off
for %%f in (*.css *.js *.html) do (
    python code_splitter.py "%%f" -l 400
)

# Linux/Mac æ‰¹æ¬¡è…³æœ¬ (.sh)
#!/bin/bash
for file in *.css *.js *.html; do
    python code_splitter.py "$file" -l 400
done
```


#### 2. èˆ‡ç‰ˆæœ¬æ§åˆ¶æ•´åˆ

```bash
# å°‡åˆ†æ®µç›®éŒ„åŠ å…¥ .gitignore
echo "split_*/" >> .gitignore

# æˆ–è€…åªè¿½è¹¤æ‘˜è¦æª”æ¡ˆ
git add split_*/README.md
git add split_*/*_split_summary.json
```

é€™å€‹å·¥å…·åŒ…è®“æ‚¨èƒ½å¤ å®‰å…¨ã€é«˜æ•ˆåœ°è™•ç†ä»»ä½•éé•·çš„ç¨‹å¼ç¢¼æª”æ¡ˆï¼Œå®Œå…¨ä¸å½±éŸ¿åŸå§‹æª”æ¡ˆçš„åŠŸèƒ½ï¼ŒåŒæ™‚æä¾›æœ€ä½³çš„ AI äº’å‹•é«”é©—ï¼

